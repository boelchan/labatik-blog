var main={checkAuth:function(e){null!=e.relogin&&$("#modal_login").modal("show")},alertMessage:function(e,t,a){"success"==t?swal({title:e,type:"success",timer:1e3,showConfirmButton:!1}).then(function(){a.url&&("reload"==a.url?location.reload():window.location.replace(a.url))},function(e){"timer"===e&&a.url&&("reload"==a.url?location.reload():window.location.replace(a.url))}):("error"==t&&(t="danger"),swal({title:e,type:"error",timer:1500,showConfirmButton:!1,showCloseButton:!0}))},resetForm:function(e){e.find("input[type=text], input[type=hidden], textarea, input[type=password]").val("")},submitAjax:function(e,t={}){var a=e.find("button[type=submit]");if("multipart/form-data"==e.attr("enctype")){var o=new FormData(e[0]);t.cache=!1,t.contentType=!1,t.processData=!1}else o=e.serialize();$(".help-block-error",e).remove(),$(".form-group",e).removeClass("has-error"),t=$.extend(!0,{url:e.attr("action"),dataType:"json",data:o,type:"post",headers:{authorization:localStorage.getItem("tokenApp")},beforeSend:function(e){a.button("loading")},success:function(a){1==a.success?(1==a.reset&&main.resetForm(e),t.f_response&&"function"==typeof t.f_response&&t.f_response(a),t.f_success&&"function"==typeof t.f_success&&t.f_success(),a.datatable&&$("#"+a.datatable).DataTable().ajax.reload(),"undefined"!=typeof datatableAjax&&datatableAjax&&datatableAjax.getDataTable().ajax.reload(),t.f_modal?toastr.success(a.message):(e.parents(".modal").modal("hide"),main.alertMessage(a.message,"success",a))):(a.message&&main.alertMessage(a.message,"error"),a.field_error&&main.setErrorForm(a.field_error,e))}},t),$.ajax(t).fail(function(){a.button("reset"),main.alertMessage("Oops!','Maaf, telah terjadi kesalahan.","error")}).always(function(){a.button("reset")})},setErrorForm:function(e,t){$.each(e,function(e,a){var o=$("[name='"+e+"']",t),n=$("<span/>").addClass("help-block help-block-error").html(a);o.closest(".form-group").addClass("has-error"),o.parent(".input-group").length?n.insertAfter(o.parent()):o.hasClass("select2-hidden-accessible")?n.insertAfter(o.next("span")):n.insertAfter(o)})},dropdownAjax:function(e,t,a){e.html("<option value='' >Loading...</option>"),e.select2("val",""),$.ajax({url:a,type:"POST",dataType:"json",data:t,beforeSend:function(t){e.prop("disabled",!0)}}).done(function(t){if(console.log("success"),t){if(t.length>0){for(e.html("<option value='' >Pilih</option>"),i=0;i<t.length;i++){var a="<option value='"+t[i].id+"' ";a+=" >"+t[i].nama+"</option>",e.append(a)}e.prop("disabled",!1)}else e.html("<option value='0' >Tidak ada data</option>"),console.log("data not found");e.select2("val","")}}).fail(function(e){console.log("error")}).always(function(){})},simpleDatatable:function(e){var t=function(e){var t=new Datatable;t.init({src:e.src,dataTable:{ajax:{url:e.url},order:[[1,"asc"]]}})};jQuery(document).ready(function(){t(e)})},loadPage:function(e,t){e.html(""),App.blockUI({target:e,animate:!0}),setTimeout(function(){e.load(t,function(e){})},500)}},myjs=function(){var e=function(){if($().select2){function e(e){if(e.loading)return e.text;var t="<div class='select2-result-repository clearfix'>";return void 0!==e.img&&(t+="<div class='select2-result-repository__avatar'><img src='"+e.img+"' /></div>"),void 0!==e.title&&(t+="<div class='select2-result-repository__title'>"+e.title+"</div>"),void 0!==e.desc&&(t+="<div class='select2-result-repository__description'>"+e.desc+"</div>"),void 0!==e.rating&&(t+="<div class='select2-result-repository__stargazers'>"+e.rating+" <span class='glyphicon glyphicon-star'></span></div></div>"),t}function t(e){return e.title||e.text}$.fn.select2.defaults.set("theme","bootstrap"),$(".select2").select2({placeholder:"Pilih",width:"auto",allowClear:!1}),$(".select2-ajax").each(function(){var a=$(this),o=$(this).attr("data-url");if("false"==$(this).attr("data-allowClear"))var n=!1;else n=!0;a.select2({placeholder:"Pilih",allowClear:n,width:"off",ajax:{url:o,dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,t){return t.page=t.page||1,{results:e.items,pagination:{more:30*t.page<e.total_count}}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:0,templateResult:e,templateSelection:t})})}},t=function(){jQuery().datepicker&&($(".date-picker").datepicker({rtl:App.isRTL(),orientation:"left",format:"dd-mm-yyyy",autoclose:!0}),$(".date-decade").datepicker({rtl:App.isRTL(),orientation:"left",format:"yyyy-mm-dd",startView:"decade",autoclose:!0}),$(".date-year").datepicker({rtl:App.isRTL(),orientation:"left",format:"yyyy",minViewMode:"years",autoclose:!0}))},a=function(){$(".upload_img_single").click(function(e){console.log("a");var t="#"+$(this).attr("id"),a=$(this).attr("src"),o=$(this).attr("folder"),n="#"+$(this).parent().find("input:hidden").attr("id"),i={targetImgId:t,photo:a,hiddenInputId:n,folder:o};if(null===document.getElementById("div_upload")){var r=document.createElement("div");r.id="div_upload",$(this).parent().append(r)}$("#div_upload").load(site_url+"/upload/single",i,function(){})})},o=function(){$("body").on("click",".openmodal",function(e){e.preventDefault(),$("#temp_modal").load($(this).data("url"),{modal:!0},function(){})})},n=function(){if(jQuery().summernote){function e(e){var t=new FormData;t.append("image",e),t.append(csrfName,csrfHash),$.ajax({url:site_url+"form/upload_img_summernote",cache:!1,contentType:!1,processData:!1,data:t,type:"POST",success:function(e){$(".summernote").summernote("insertImage",e)},error:function(e){console.log(e)}})}function t(e){$.ajax({data:{src:e,csrfName:csrfHash},type:"POST",url:site_url+"form/delete_img_summernote",cache:!1,success:function(e){console.log(e)}})}$(".summernote").summernote({height:300,toolbar:[["font",["bold","underline"]],["fontsize",["fontsize"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","video","picture"]],["view",["fullscreen"]]],callbacks:{onImageUpload:function(t){e(t[0])},onMediaDelete:function(e){t(e[0].src)}}})}},i=function(){jQuery().timepicker&&($(".timepicker-default").timepicker({autoclose:!0,showSeconds:!0,minuteStep:1}),$(".timepicker-no-seconds").timepicker({autoclose:!0,minuteStep:5,defaultTime:!1}),$(".timepicker-24").timepicker({autoclose:!0,minuteStep:5,showSeconds:!1,showMeridian:!1}),$(".timepicker").parent(".input-group").on("click",".input-group-btn",function(e){e.preventDefault(),$(this).parent(".input-group").find(".timepicker").timepicker("showWidget")}),$(document).scroll(function(){$("#form_modal4 .timepicker-default, #form_modal4 .timepicker-no-seconds, #form_modal4 .timepicker-24").timepicker("place")}))},r=function(){jQuery().inputmask&&($(".mask-number").inputmask({mask:"9",repeat:10,greedy:!1}),$(".mask-number3").inputmask({mask:"9",repeat:3,greedy:!1}),$(".mask-nik").inputmask({mask:"9",repeat:16,greedy:!1}),$(".mask-kode-pos").inputmask({mask:"9",repeat:5,greedy:!1}),$(".mask-tahun").inputmask({mask:"9",repeat:4,greedy:!1}))};return{init:function(){e(),t(),i(),o(),n(),r(),a()}}}();jQuery(document).ready(function(){myjs.init(),$("#input-form").submit(function(e){e.preventDefault(),main.submitAjax($(this))})});